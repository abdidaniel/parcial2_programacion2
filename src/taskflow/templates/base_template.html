<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>TaskFlow</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>

<!-- ======= NAVBAR ======= -->
<header class="navbar">
  <nav class="container">
    <a href="{{ url_for('home') }}" class="brand">TaskFlow</a>

    <button class="nav-toggle" id="nav-toggle" aria-label="Abrir menÃº">â˜°</button>

    <ul class="nav" id="nav-menu">
      {% if current_user.is_authenticated %}
        <li><span>ğŸ‘‹ {{ current_user.username }}</span></li>
        <li><a href="{{ url_for('home') }}">Inicio</a></li>
        <li><a href="{{ url_for('create_task') }}">Nueva tarea</a></li>
        <li><a href="{{ url_for('logout') }}">Cerrar sesiÃ³n</a></li>
      {% else %}
        <li><a href="{{ url_for('login') }}">Iniciar sesiÃ³n</a></li>
        <li><a href="{{ url_for('signup') }}">Registrarse</a></li>
      {% endif %}
    </ul>
  </nav>
</header>

<!-- ======= MAIN ======= -->
<main class="container">
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="flash">
        {% for category, message in messages %}
          <div class="flash-item {{ category }}">{{ message }}</div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  {% block content %}{% endblock %}
</main>

<!-- ======= MODAL DE CONFIRMACIÃ“N ======= -->
<div id="confirmModal" class="modal">
  <div class="modal-content">
    <h3>Â¿EstÃ¡s seguro de que deseas eliminar esta tarea?</h3>
    <p>Esta acciÃ³n no se puede deshacer.</p>
    <div class="modal-buttons">
      <form id="deleteForm" method="POST">
        <button type="submit" class="btn danger">SÃ­, eliminar</button>
      </form>
      <button class="btn cancel" id="cancelBtn">No</button>
    </div>
  </div>
</div>

<!-- ======= SCRIPTS ======= -->
<script>
  // --- MENÃš RESPONSIVE ---
  document.addEventListener('DOMContentLoaded', () => {
    const toggle = document.getElementById('nav-toggle');
    const menu = document.getElementById('nav-menu');

    if (toggle && menu) {
      toggle.addEventListener('click', () => {
        menu.classList.toggle('active');
      });
    }
  });

  // --- MODAL GLOBAL PARA ELIMINAR ---
  document.addEventListener("DOMContentLoaded", () => {
    const modal = document.getElementById("confirmModal");
    const cancelBtn = document.getElementById("cancelBtn");
    const deleteForm = document.getElementById("deleteForm");

    // Inicialmente oculto
    modal.style.display = "none";

    // FunciÃ³n global
    window.confirmDelete = function(actionUrl) {
      deleteForm.action = actionUrl;
      modal.style.display = "flex";
    };

    // Cerrar con botÃ³n "No"
    cancelBtn.addEventListener("click", () => {
      modal.style.display = "none";
    });

    // Cerrar al hacer clic fuera del modal
    window.addEventListener("click", (e) => {
      if (e.target === modal) modal.style.display = "none";
    });
  });
</script>

<!-- ======= FOOTER ======= -->
<footer class="footer">
  <p>&copy; 2025 TaskFlow â€“ Gestor de Tareas</p>
</footer>

</body>
</html>
